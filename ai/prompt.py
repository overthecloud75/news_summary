SUMMARY_KOREAN_TO_KOREAN = '''이 문서의 주요 내용을 요약해 주세요. 요약은 간결하게 하되, 문서의 핵심 정보를 포함해야 하며 고유 명사를 제외하고는 한국어로 표시가 되어야 합니다.

문서: {}

요약:
'''

SUMMARY_ENGLISTH_TO_KOREAN = '''다음 영어 텍스트를 한국어로 번역을 한 후 요약을 하세요. 반드시 한국어로만 출력해야 합니다. 영어로 출력하지 마세요. 요약은 간결하게 하되, 문서의 핵심 정보를 포함해야 하며 고유 명사를 제외하고는 한국어로 표시가 되어야 합니다.

문서: {}

요약:
'''

SECURITY_REPORT = '''### 보고서 작성 지침
보안 위협 동향 보고서 : [제목 입력]
보고서의 주요 대상은 [보고서 대상 (예: 기업 경영진, 보안 관리자)]입니다.
보고서에는 작성일 및 대상(예: 기업 경영진, 보안 관리자) 정보는 포함하지 마세요.
IoC 정보는 문서에 내용이 없으면 작성하지 마세요.
아래의 지침과 질문에 따라 보고서를 작성해 주세요.

1. 문서 내용 요약
문서를 분석하여 강조된 주요 보안 위협 유형과 특징을 요약하고 목록으로 제시하세요.

2. 상세 분석
각 위협 유형에 대해 다음 정보를 포함하여 목록 형태로 구조화하여 설명하세요:

 - 기술적 배경
 - 주요 특징 또는 전개 방식 (관련 통계나 데이터가 있다면 함께 명시)

3. 공격 기술 분석
각 위협 유형에 대해 사용된 공격 기법과 절차를 다음 형식으로 정리하세요:

 - 공격 단계: (예: 초기 침투, 권한 상승, 내부 확산 등)
 - 사용된 기법: MITRE ATT&CK 기반 ID 및 명칭 포함 (예: T1566.001 - Spearphishing Attachment)
 - 사용된 도구 또는 악성코드 (명시된 경우)

4. IoC (Indicators of Compromise)
각 위협에 대해 문서에 포함되었거나 파생 가능한 IoC를 다음 항목별로 구체적으로 정리하세요:

 - 도메인 / URL
 - IP 주소
 - 파일 해시 (MD5/SHA256)
 - 프로세스명 / 파일 경로
 - 레지스트리 / 서비스 등록 정보 (해당 시)

5. 탐지 방안
다음 보안 장비 또는 로그 기반에서 탐지 가능한 방안을 항목별로 정리하세요.
각 장비별로 탐지 포인트 또는 룰 조건을 명확히 작성하세요:
 - EDR / Proxy / Firewall / IPS / WAF / Web Log

6. 예방 및 대응 방안
문서에 제시된 위협에 대해, 적용 가능한 구체적인 예방 및 대응 방안을 제시하세요.

7. 시사점
문서 분석을 기반으로, [보고서 대상]이 인지해야 할 보안 강화에 필요한 주요 시사점과 고려 사항을 도출하세요.

8. 결론 및 제언
보안 위협 동향을 간결하게 요약하고, 향후 전망과 제언을 종합하여 제시하세요.

※ 주의사항:

보고서의 맨 앞에 "보안 위협 동향 보고서 : [제목]" 형식의 제목을 삽입하세요.
작성일과 보고서 대상 정보는 포함하지 마세요.
IoC 정보는 문서에 내용이 없으면 작성하지 마세요.
문서의 핵심 내용을 정확히 반영하며, 필요한 경우 문서의 일부를 인용하세요.
명확하고 간결한 언어를 사용하세요.

### 문서: 
{}

### 출력 형식:

# 보안 위협 동향 보고서 : ...

## 1. 문서 요약
- ...
- ...
- ...

## 2. 상세 분석

### ...
- **기술적 배경**: ...
- **주요 특징**: ...
- **관련 통계**: ...

### ...
- **기술적 배경**: ...
- **주요 특징**: ...

## 3. 공격 기술 분석

### ...
- **공격 단계**:  
  ...
- **사용된 기법**:  
  ...
  ...
- **도구/악성코드**: ...

## 4. IoC

### ...
- 도메인: ...
- IP: ...
- 파일 해시: SHA256 - ...
- 프로세스명: ...
- 레지스트리: ...

## 5. 탐지 방안

- **EDR**: ...
- **Firewall**: ...
- **IPS**: ...
- **WAF**: ... 
- **Web Log**: ...

## 6. 예방 및 대응 방안

- ...
- ...
- ...

## 7. 시사점

- ...
- ...

## 8. 결론 및 제언

- ...
- ...
'''

REPORT = '''### 보고서 작성 지침
AI 보고서 : [제목 입력]
보고서의 주요 대상은 [보고서 대상 (예: 기업 경영진, IT 관리자)]입니다.
보고서에는 작성일이나 대상 정보는 포함하지 마세요.
다음 지침에 따라 구성해 주세요:

1. 문서 내용 요약
문서를 분석하여 강조된 주요 특징을 요약하고 목록으로 정리하세요.

2. 상세 분석
문서의 내용을 충실히 반영하여, 다음 항목을 포함하는 구조적인 목록 형태로 작성하세요.

 - 기술적 배경
 - 주요 특징 또는 전개 방식 (관련 통계나 데이터가 있다면 함께 명시)

3. 시사점
문서 분석을 기반으로, [보고서 대상]이 인지해야 할 핵심 시사점과 고려사항을 도출해 설명하세요.

4. 결론 및 제언
문서의 정보와 추가 분석을 종합하여 향후 전망과 제언을 제시하세요.

※ 주의사항:

보고서의 맨 앞에 "AI 보고서 : [제목]" 형식의 제목을 삽입하세요.
작성일과 보고서 대상 정보는 포함하지 마세요.
문서의 핵심 내용을 정확히 반영하며, 필요한 경우 문서의 일부를 인용하세요.
명확하고 간결한 언어를 사용하세요.

### 문서: 
{}
'''

SECURITY_REPORT_KOREAN_TO_KOREAN = '''제공된 문서를 기반으로, 보안 위협 동향 보고서를 작성해야 합니다.\n''' + SECURITY_REPORT

SECURITY_REPORT_ENGLISH_TO_KOREAN = '''제공된 영문 문서를 기반으로, 한국어로 번역하여 보안 위협 동향 보고서를 작성해야 합니다.\n''' + SECURITY_REPORT

REPORT_KOREAN_TO_KOREAN = '''제공된 문서를 기반으로, 보고서를 작성해 주세요.\n''' + REPORT

REPORT_ENGLISH_TO_KOREAN = '''제공된 영문 문서를 기반으로, 한국어로 번역하여 작성해 주세요.\n''' + REPORT 

REVISED_REPORT_PROMPT = '''제공된 Report를 개선해줘. Report의 내용을 분석하여 더 명확하고 간결하며 효과적이면서 목록화된 형태로 재구성해줘. 불필요한 표현은 삭제하고, 필요한 경우 추가적인 정보를 제공하거나 논리적인 흐름을 개선해줘. 최종 결과물은 개선된 Report 내용만 포함해야 하며, "개선본"과 같은 별도 표시는 하지 않아도 돼. 결론이나 시사점 내용은 포함이 되어 있어야 해.

보고서:
{}
'''

REVISED_REPORT_PROMPT_WITHOUT_REPORT = '''제공된 Report를 개선해줘. Report의 내용을 분석하여 더 명확하고 간결하며 효과적이면서 목록화된 형태로 재구성해줘. 불필요한 표현은 삭제하고, 필요한 경우 추가적인 정보를 제공하거나 논리적인 흐름을 개선해줘. 최종 결과물은 개선된 Report 내용만 포함해야 하며, "개선본"과 같은 별도 표시는 하지 않아도 돼. 결론이나 시사점 내용은 포함이 되어 있어야 해.
'''

CATEGORY_PROMPT = '''다음 문서를 읽고 아래 카테고리 중 하나로 분류하세요.
카테고리:
{}

문서: {}

출력은 해당 카테고리 이름만 작성하세요. 
'''

CATEGORY_FEW_PROMPT = '''당신은 전문적인 텍스트 분류기입니다. 주어진 텍스트를 미리 정의된 카테고리 중 하나로 분류하고, 각 카테고리에 대한 확률을 계산하세요.

### 카테고리:
{}

다음 텍스트에 대해 출력하세요:
1. 예측된 카테고리.
2. 각 카테고리에 대한 확률 점수(0과 1 사이).

### 출력 예시:
카테고리: 스포츠
확률:
- 스포츠: 0.90
- 정치: 0.05  
- 기타: 0.05

### 입력:
{}
'''

CATEGORY_FEW_JSON_PROMPT = '''당신은 전문적인 텍스트 분류기입니다. 
주어진 텍스트를 미리 정의된 카테고리 중 가장 높은 수치의 하나로 분류하고, 각 카테고리에 대한 확률을 계산하세요. 
출력은 반드시 JSON 형식으로 작성하세요.

### 카테고리:
{}

다음 텍스트에 대해 JSON 형식으로 출력하세요:
predicted 키에는 예측된 카테고리의 이름을 포함하세요.
probabilities 키에는 각 카테고리와 해당 확률을 포함한 딕셔너리를 작성하세요.

### 입력:
{}

### 출력 예시:
```json
{{
  "predicted": "스포츠",
  "probabilities": {{
    "스포츠": 0.85,
    "정치": 0.13,
    "기타": 0.02
  }}
}}
```
'''

CATEGORY_REPORT_PROMPT = '''다음 문서가 리포트(보고서) 작성의 기반으로 **활용하기에 적합한지 평가만 해 주세요.**  
📌 **중요: 평가만 수행하세요. 문서를 요약하거나 보고서를 작성하지 마세요.**

다음 기준을 바탕으로 각 항목별로 0~20점, 총 100점 만점으로 평가해 주세요:

### 평가 기준:
1. 정보의 명확성: 문서가 명확하고 이해하기 쉬운가?
2. 구조의 체계성: 목차, 제목, 단락 등이 논리적으로 구성되어 있는가?
3. 정보의 신뢰도: 출처가 명확하거나 신뢰할 수 있는 데이터나 사실에 기반하고 있는가?
4. 내용의 목적 적합성: 해당 문서가 리포트 주제나 목적에 부합하는 정보를 포함하고 있는가?
5. 요약 가능성: 핵심 내용이 잘 드러나 있어 요약이나 인용이 쉬운가?

- 각 항목에 대해 0~20점의 점수를 부여해 주세요. (총점: 100점)

📌 **주의**:  
- **보고서를 작성하지 마세요.**  
- **문서 내용을 요약하거나 재구성하지 마세요.**  
- **문서의 평가만 수행해 주세요.**

### 입력 (평가할 문서):
{}

### 출력 형식:

## 평가 결과

- 총점: XX점

### 세부 항목 평가

- 정보의 명확성 (X/20): ...
- 구조의 체계성 (X/20): ...
- 정보의 신뢰도 (X/20): ...
- 내용의 목적 적합성 (X/20): ...
- 요약 가능성 (X/20): ...
'''

DGA_FEW_JSON_PROMPT = '''다음 도메인이 DGA(Domain Generation Algorithm)에 의해 생성된 것인지 판단하고, DGA 도메인일 확률을 0%에서 100% 사이로 추정하여 JSON 형태로 출력하세요.  
판단 시 다음 요소를 각각 분석하고, 각 요소에 대한 DGA 가능성을 확률로 제시한 후 최종 DGA일 확률을 출력하세요.  

판단 요소:
1. 도메인 이름의 길이
2. 무작위 문자나 숫자의 비율
3. 의미 있는 단어의 포함 여부
4. 일반적으로 사용되는 도메인 구조와의 유사성  

결과는 다음 JSON 형식으로 작성하세요:
```json
{
  "domain": "{}",
  "analysis": {
    "length_based_probability": X%, 
    "randomness_based_probability": X%, 
    "meaningful_word_probability": X%, 
    "structure_similarity_probability": X%
  },
  "final_probability": X%,
  "decision": "DGA 도메인일 가능성이 [낮음/높음]"
}

'''

